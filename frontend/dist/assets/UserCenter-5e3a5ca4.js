import{u as I,a as h}from"./index-8cce7ed6.js";import{A as y}from"./AssetPieChart-c10643e7.js";import{_ as C,k,o as n,c as l,b as e,t as i,n as g,e as S,l as T,f as v,F as p,r as b}from"./index-0403a620.js";const _={name:"UserCenter",components:{AssetPieChart:y},data(){return{userInfo:{},userAssets:{balance:0,totalIncome:0},assetsBreakdown:{fixed:0,current:0,other:0},assetsLoaded:!1,orders:[],loadingOrders:!1,unreadMessages:3}},computed:{userStatusText(){switch(this.userInfo.status||""){case"NORMAL":return"æ­£å¸¸";case"LOCKED":return"å·²é”å®š";case"FROZEN":return"å·²å†»ç»“";default:return"æœªçŸ¥çŠ¶æ€"}},userStatusClass(){switch(this.userInfo.status||""){case"NORMAL":return"status-normal";case"LOCKED":return"status-locked";case"FROZEN":return"status-frozen";default:return""}},recentOrders(){return this.orders.slice(0,3)}},created(){const r=localStorage.getItem("userInfo");if(r)try{this.userInfo=JSON.parse(r),this.loadUserInfo()}catch(s){console.error("è§£æžç”¨æˆ·ä¿¡æ¯å¤±è´¥",s),this.userInfo={}}else this.$route.params.userId?(this.userInfo.userId=this.$route.params.userId,this.loadUserInfo()):console.warn("æœªæ‰¾åˆ°ç”¨æˆ·ä¿¡æ¯");this.loadOrders()},methods:{async loadUserInfo(){if(!this.userInfo.userId){console.warn("ç¼ºå°‘ç”¨æˆ·IDï¼Œæ— æ³•åŠ è½½ç”¨æˆ·ä¿¡æ¯");return}try{const r=await I.getUserInfo(this.userInfo.userId);let s=null;r&&typeof r=="object"&&(r.data&&typeof r.data=="object"?s=r.data:typeof r=="object"&&r.userId&&(s=r)),s&&s.userId?(this.userInfo={...this.userInfo,...s},this.userAssets={balance:s.balance||0,totalIncome:0},this.assetsBreakdown={fixed:s.balance*.68||0,current:s.balance*.24||0,other:s.balance*.08||0},this.assetsLoaded=!0):console.warn("èŽ·å–ç”¨æˆ·ä¿¡æ¯ä¸ºç©º")}catch(r){console.error("åŠ è½½ç”¨æˆ·ä¿¡æ¯å¤±è´¥",r)}},async loadOrders(){if(!this.userInfo.userId){console.warn("ç¼ºå°‘ç”¨æˆ·IDï¼Œæ— æ³•åŠ è½½è®¢å•ä¿¡æ¯");return}this.loadingOrders=!0;try{const r=await h.getUserOrders(this.userInfo.userId);let s=[];r&&typeof r=="object"&&(r.data&&Array.isArray(r.data)?s=r.data:Array.isArray(r)&&(s=r)),this.orders=s;let u=0;Array.isArray(this.orders)&&this.orders.forEach(d=>{d.status==="SUCCESS"&&d.expectedIncome&&(u+=parseFloat(d.expectedIncome))}),this.userAssets.totalIncome=u}catch(r){console.error("åŠ è½½è®¢å•åˆ—è¡¨å¤±è´¥",r),this.orders=[]}finally{this.loadingOrders=!1}},getOrderStatusText(r){return{SUCCESS:"å·²å®Œæˆ",PROCESSING:"å¤„ç†ä¸­",PENDING:"å¾…æ”¯ä»˜",FAILED:"å·²å¤±è´¥",CANCELLED:"å·²å–æ¶ˆ"}[r]||r},formatCurrency(r){return parseFloat(r).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")},formatDateTime(r){if(!r)return"";const s=new Date(r),u=s.getFullYear(),d=String(s.getMonth()+1).padStart(2,"0"),a=String(s.getDate()).padStart(2,"0"),t=String(s.getHours()).padStart(2,"0"),c=String(s.getMinutes()).padStart(2,"0");return`${u}-${d}-${a} ${t}:${c}`},viewOrderDetail(r){this.$router.push(`/order/${r.orderNo}`)},goToOrders(){this.$router.push("/orders")},goToProducts(){this.$router.push("/products")},goToAssets(){this.$router.push("/assets")},goToMessages(){this.$router.push("./messages")},editProfile(){this.$router.push("./profile/edit")},goToSettings(){this.$router.push("./security")},goToSecurity(){this.$router.push("./security")},goToHelp(){this.$router.push("./help")},contactService(){alert("å®¢æœç”µè¯ï¼š400-123-4567")},logout(){confirm("ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ")&&(localStorage.removeItem("token"),localStorage.removeItem("userInfo"),this.$router.push("./login"))}}},w={class:"user-center-page"},A={class:"header"},O={class:"user-card"},x={class:"user-avatar"},N={class:"avatar"},D={class:"user-info"},M={class:"user-name"},E={class:"user-id"},L={class:"user-assets"},P={class:"asset-item"},U={class:"asset-value"},B={class:"asset-item"},F={class:"asset-value income"},R={class:"quick-actions"},j={key:0,class:"badge"},H={class:"assets-overview"},V={class:"section-header"},z={class:"assets-chart"},G={key:1,class:"loading-placeholder"},K={class:"assets-breakdown"},Z={class:"breakdown-item"},q={class:"item-value"},J={class:"breakdown-item"},Y={class:"item-value"},Q={class:"breakdown-item"},W={class:"item-value"},X={class:"recent-orders"},$={class:"section-header"},ss={key:0,class:"loading"},es={key:1,class:"empty-orders"},ts={key:2,class:"orders-list"},rs=["onClick"],os={class:"order-header"},as={class:"order-product"},is={class:"order-details"},ns={class:"detail-row"},ls={class:"value"},ds={class:"detail-row"},us={class:"value income"},cs={class:"detail-row"},vs={class:"value"},ms={class:"menu-list"},fs={class:"logout-section"};function gs(r,s,u,d,a,t){var m,f;const c=k("AssetPieChart");return n(),l("div",w,[e("div",A,[e("div",{class:"back-btn",onClick:s[0]||(s[0]=o=>r.$router.back())},[...s[14]||(s[14]=[e("span",null,"<",-1)])]),s[16]||(s[16]=e("h1",{class:"title"},"ä¸ªäººä¸­å¿ƒ",-1)),e("div",{class:"settings-btn",onClick:s[1]||(s[1]=(...o)=>t.goToSettings&&t.goToSettings(...o))},[...s[15]||(s[15]=[e("span",null,"âš™ï¸",-1)])])]),e("div",O,[e("div",x,[e("div",N,i(((m=a.userInfo.userName)==null?void 0:m.charAt(0))||((f=a.userInfo.realName)==null?void 0:f.charAt(0))||"U"),1)]),e("div",D,[e("div",M,i(a.userInfo.userName||a.userInfo.realName||"æœªçŸ¥ç”¨æˆ·"),1),e("div",E,"ID: "+i(a.userInfo.userId||"æœªçŸ¥"),1),e("div",{class:g(["user-status",t.userStatusClass])},i(t.userStatusText),3)]),e("div",L,[e("div",P,[s[17]||(s[17]=e("div",{class:"asset-label"},"è´¦æˆ·ä½™é¢",-1)),e("div",U,"Â¥"+i(t.formatCurrency(a.userAssets.balance||0)),1)]),e("div",B,[s[18]||(s[18]=e("div",{class:"asset-label"},"ç´¯è®¡æ”¶ç›Š",-1)),e("div",F,"Â¥"+i(t.formatCurrency(a.userAssets.totalIncome||0)),1)])])]),e("div",R,[e("div",{class:"action-item",onClick:s[2]||(s[2]=(...o)=>t.goToOrders&&t.goToOrders(...o))},[...s[19]||(s[19]=[e("div",{class:"action-icon"},"ðŸ“‹",-1),e("div",{class:"action-text"},"æˆ‘çš„è®¢å•",-1)])]),e("div",{class:"action-item",onClick:s[3]||(s[3]=(...o)=>t.goToProducts&&t.goToProducts(...o))},[...s[20]||(s[20]=[e("div",{class:"action-icon"},"ðŸ¦",-1),e("div",{class:"action-text"},"ç†è´¢äº§å“",-1)])]),e("div",{class:"action-item",onClick:s[4]||(s[4]=(...o)=>t.goToAssets&&t.goToAssets(...o))},[...s[21]||(s[21]=[e("div",{class:"action-icon"},"ðŸ’°",-1),e("div",{class:"action-text"},"èµ„äº§æ¦‚è§ˆ",-1)])]),e("div",{class:"action-item",onClick:s[5]||(s[5]=(...o)=>t.goToMessages&&t.goToMessages(...o))},[s[22]||(s[22]=e("div",{class:"action-icon"},"ðŸ””",-1)),s[23]||(s[23]=e("div",{class:"action-text"},"æ¶ˆæ¯é€šçŸ¥",-1)),a.unreadMessages>0?(n(),l("div",j,i(a.unreadMessages),1)):S("",!0)])]),e("div",H,[e("div",V,[s[24]||(s[24]=e("h2",{class:"section-title"},"èµ„äº§åˆ†å¸ƒ",-1)),e("div",{class:"section-action",onClick:s[6]||(s[6]=(...o)=>t.goToAssets&&t.goToAssets(...o))},"æŸ¥çœ‹è¯¦æƒ… â€º")]),e("div",z,[a.assetsLoaded?(n(),T(c,{key:0,data:a.assetsBreakdown},null,8,["data"])):(n(),l("div",G,"åŠ è½½ä¸­..."))]),e("div",K,[e("div",Z,[s[25]||(s[25]=e("div",{class:"item-label"},[e("span",{class:"color-dot dot1"}),v(" å®šæœŸå­˜æ¬¾ ")],-1)),e("div",q,"Â¥"+i(t.formatCurrency(a.assetsBreakdown.fixed||0)),1)]),e("div",J,[s[26]||(s[26]=e("div",{class:"item-label"},[e("span",{class:"color-dot dot2"}),v(" æ´»æœŸå­˜æ¬¾ ")],-1)),e("div",Y,"Â¥"+i(t.formatCurrency(a.assetsBreakdown.current||0)),1)]),e("div",Q,[s[27]||(s[27]=e("div",{class:"item-label"},[e("span",{class:"color-dot dot3"}),v(" å…¶ä»–ç†è´¢ ")],-1)),e("div",W,"Â¥"+i(t.formatCurrency(a.assetsBreakdown.other||0)),1)])])]),e("div",X,[e("div",$,[s[28]||(s[28]=e("h2",{class:"section-title"},"æœ€è¿‘è®¢å•",-1)),e("div",{class:"section-action",onClick:s[7]||(s[7]=(...o)=>t.goToOrders&&t.goToOrders(...o))},"æŸ¥çœ‹æ›´å¤š â€º")]),a.loadingOrders?(n(),l("div",ss,"åŠ è½½ä¸­...")):t.recentOrders.length===0?(n(),l("div",es,[...s[29]||(s[29]=[e("div",{class:"empty-icon"},"ðŸ“­",-1),e("div",{class:"empty-text"},"æš‚æ— è®¢å•è®°å½•",-1)])])):(n(),l("div",ts,[(n(!0),l(p,null,b(t.recentOrders,o=>(n(),l("div",{key:o.id,class:"order-card",onClick:Is=>t.viewOrderDetail(o)},[e("div",os,[e("div",as,i(o.productName),1),e("div",{class:g(["order-status",o.status])},i(t.getOrderStatusText(o.status)),3)]),e("div",is,[e("div",ns,[s[30]||(s[30]=e("span",{class:"label"},"è´­ä¹°é‡‘é¢",-1)),e("span",ls,"Â¥"+i(t.formatCurrency(o.amount)),1)]),e("div",ds,[s[31]||(s[31]=e("span",{class:"label"},"é¢„æœŸæ”¶ç›Š",-1)),e("span",us,"Â¥"+i(t.formatCurrency(o.expectedIncome)),1)]),e("div",cs,[s[32]||(s[32]=e("span",{class:"label"},"ä¸‹å•æ—¶é—´",-1)),e("span",vs,i(t.formatDateTime(o.createTime)),1)])])],8,rs))),128))]))]),e("div",ms,[e("div",{class:"menu-item",onClick:s[8]||(s[8]=(...o)=>t.editProfile&&t.editProfile(...o))},[...s[33]||(s[33]=[e("div",{class:"menu-icon"},"ðŸ‘¤",-1),e("div",{class:"menu-text"},"ä¸ªäººä¿¡æ¯",-1),e("div",{class:"menu-arrow"},"â€º",-1)])]),e("div",{class:"menu-item",onClick:s[9]||(s[9]=(...o)=>t.goToSecurity&&t.goToSecurity(...o))},[...s[34]||(s[34]=[e("div",{class:"menu-icon"},"ðŸ”’",-1),e("div",{class:"menu-text"},"å®‰å…¨è®¾ç½®",-1),e("div",{class:"menu-arrow"},"â€º",-1)])]),e("div",{class:"menu-item",onClick:s[10]||(s[10]=(...o)=>t.goToMessages&&t.goToMessages(...o))},[...s[35]||(s[35]=[e("div",{class:"menu-icon"},"ðŸ””",-1),e("div",{class:"menu-text"},"æ¶ˆæ¯é€šçŸ¥",-1),e("div",{class:"menu-arrow"},"â€º",-1)])]),e("div",{class:"menu-item",onClick:s[11]||(s[11]=(...o)=>t.goToHelp&&t.goToHelp(...o))},[...s[36]||(s[36]=[e("div",{class:"menu-icon"},"â“",-1),e("div",{class:"menu-text"},"å¸®åŠ©ä¸­å¿ƒ",-1),e("div",{class:"menu-arrow"},"â€º",-1)])]),e("div",{class:"menu-item",onClick:s[12]||(s[12]=(...o)=>t.contactService&&t.contactService(...o))},[...s[37]||(s[37]=[e("div",{class:"menu-icon"},"ðŸ‘¨â€ðŸ’¼",-1),e("div",{class:"menu-text"},"è”ç³»å®¢æœ",-1),e("div",{class:"menu-arrow"},"â€º",-1)])])]),e("div",fs,[e("button",{class:"logout-btn",onClick:s[13]||(s[13]=(...o)=>t.logout&&t.logout(...o))}," é€€å‡ºç™»å½• ")])])}const ks=C(_,[["render",gs],["__scopeId","data-v-fee59b84"]]);export{ks as default};
