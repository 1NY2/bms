import{u as m}from"./index-8cce7ed6.js";import{_ as v,o as n,c as d,b as i,t as u,h as w,d as l,v as a,w as c,e as f,F as p}from"./index-0403a620.js";const g={name:"SecuritySetting",data(){return{userInfo:{},isCertified:!1,certifiedName:"",idCard:"",showCertificationDialog:!1,showPasswordDialog:!1,certificationForm:{name:"",idCard:""},passwordForm:{oldPassword:"",newPassword:"",confirmPassword:""}}},computed:{maskedIdCard(){return this.idCard?this.idCard.substring(0,4)+"**********"+this.idCard.substring(14):""}},created(){const e=localStorage.getItem("userInfo");if(e)try{this.userInfo=JSON.parse(e),this.loadUserInfo()}catch(s){console.error("解析用户信息失败",s),this.userInfo={}}},methods:{async loadUserInfo(){if(!this.userInfo.userId){console.warn("缺少用户ID，无法加载用户信息");return}try{const e=await m.getUserInfo(this.userInfo.userId),s=e&&e.data||null;s&&s.userId&&(this.userInfo={...this.userInfo,...s},s.userName&&s.idCard&&(this.isCertified=!0,this.certifiedName=s.userName,this.idCard=s.idCard))}catch(e){console.error("加载用户信息失败",e)}},submitCertification(){if(!this.certificationForm.name||!this.certificationForm.idCard){alert("请填写完整的实名认证信息");return}if(!/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(this.certificationForm.idCard)){alert("身份证号格式不正确");return}this.isCertified=!0,this.certifiedName=this.certificationForm.name,this.idCard=this.certificationForm.idCard,this.userInfo.userName=this.certificationForm.name,this.userInfo.idCard=this.certificationForm.idCard,localStorage.setItem("userInfo",JSON.stringify(this.userInfo)),this.showCertificationDialog=!1,alert("实名认证成功")},changePassword(){if(!this.passwordForm.oldPassword||!this.passwordForm.newPassword||!this.passwordForm.confirmPassword){alert("请填写完整的密码信息");return}if(this.passwordForm.newPassword!==this.passwordForm.confirmPassword){alert("两次输入的新密码不一致");return}alert("密码修改成功"),this.passwordForm={oldPassword:"",newPassword:"",confirmPassword:""},this.showPasswordDialog=!1}}},C={class:"security-setting-page"},h={class:"header"},b={class:"security-content"},I={class:"security-section"},y={class:"section-content"},F={key:0,class:"certification-status"},P={class:"status-text"},x={class:"sub-text"},k={class:"security-section"},D={class:"section-content"},N={class:"security-section"},S={class:"section-content"},U={class:"phone-setting"},V={class:"setting-text"},B={class:"sub-text"},R={class:"security-section"},J={class:"section-content"},M={class:"email-setting"},O={class:"setting-text"},q={class:"sub-text"},A={class:"dialog-header"},E={class:"dialog-content"},T={class:"form-group"},X={class:"form-group"},_={class:"dialog-footer"},j={class:"dialog-header"},z={class:"dialog-content"},G={class:"form-group"},H={class:"form-group"},K={class:"form-group"},L={class:"dialog-footer"};function Q(e,s,W,Y,t,r){return n(),d(p,null,[i("div",C,[i("div",h,[i("div",{class:"back-btn",onClick:s[0]||(s[0]=o=>e.$router.back())},[...s[18]||(s[18]=[i("span",null,"<",-1)])]),s[19]||(s[19]=i("h1",{class:"title"},"安全设置",-1)),s[20]||(s[20]=i("div",{class:"placeholder"},null,-1))]),i("div",b,[i("div",I,[s[24]||(s[24]=i("div",{class:"section-header"},[i("h2",{class:"section-title"},"实名认证")],-1)),i("div",y,[t.isCertified?(n(),d("div",F,[s[22]||(s[22]=i("div",{class:"status-icon"},"✅",-1)),i("div",P,[s[21]||(s[21]=i("div",{class:"main-text"},"已完成实名认证",-1)),i("div",x,"姓名："+u(t.certifiedName)+" 身份证号："+u(r.maskedIdCard),1)])])):(n(),d("div",{key:1,class:"certification-required",onClick:s[1]||(s[1]=o=>t.showCertificationDialog=!0)},[...s[23]||(s[23]=[w('<div class="status-icon" data-v-649c9399>⚠️</div><div class="status-text" data-v-649c9399><div class="main-text" data-v-649c9399>未完成实名认证</div><div class="sub-text" data-v-649c9399>点击完成实名认证，保障账户安全</div></div><div class="arrow" data-v-649c9399>›</div>',3)])]))])]),i("div",k,[s[26]||(s[26]=i("div",{class:"section-header"},[i("h2",{class:"section-title"},"登录密码")],-1)),i("div",D,[i("div",{class:"password-setting",onClick:s[2]||(s[2]=o=>t.showPasswordDialog=!0)},[...s[25]||(s[25]=[i("div",{class:"setting-text"},[i("div",{class:"main-text"},"修改登录密码"),i("div",{class:"sub-text"},"建议定期更换密码，保护账户安全")],-1),i("div",{class:"arrow"},"›",-1)])])])]),i("div",N,[s[29]||(s[29]=i("div",{class:"section-header"},[i("h2",{class:"section-title"},"手机号绑定")],-1)),i("div",S,[i("div",U,[i("div",V,[s[27]||(s[27]=i("div",{class:"main-text"},"绑定手机号",-1)),i("div",B,u(t.userInfo.phoneNumber||"未绑定"),1)]),s[28]||(s[28]=i("div",{class:"arrow"},"›",-1))])])]),i("div",R,[s[32]||(s[32]=i("div",{class:"section-header"},[i("h2",{class:"section-title"},"邮箱绑定")],-1)),i("div",J,[i("div",M,[i("div",O,[s[30]||(s[30]=i("div",{class:"main-text"},"绑定邮箱",-1)),i("div",q,u(t.userInfo.email||"未绑定"),1)]),s[31]||(s[31]=i("div",{class:"arrow"},"›",-1))])])])])]),t.showCertificationDialog?(n(),d("div",{key:0,class:"dialog-overlay",onClick:s[9]||(s[9]=o=>t.showCertificationDialog=!1)},[i("div",{class:"dialog",onClick:s[8]||(s[8]=c(()=>{},["stop"]))},[i("div",A,[s[33]||(s[33]=i("h3",null,"实名认证",-1)),i("div",{class:"close-btn",onClick:s[3]||(s[3]=o=>t.showCertificationDialog=!1)},"×")]),i("div",E,[i("div",T,[s[34]||(s[34]=i("label",null,"真实姓名",-1)),l(i("input",{type:"text","onUpdate:modelValue":s[4]||(s[4]=o=>t.certificationForm.name=o),placeholder:"请输入真实姓名",class:"form-input"},null,512),[[a,t.certificationForm.name]])]),i("div",X,[s[35]||(s[35]=i("label",null,"身份证号",-1)),l(i("input",{type:"text","onUpdate:modelValue":s[5]||(s[5]=o=>t.certificationForm.idCard=o),placeholder:"请输入身份证号",class:"form-input"},null,512),[[a,t.certificationForm.idCard]])])]),i("div",_,[i("button",{class:"cancel-btn",onClick:s[6]||(s[6]=o=>t.showCertificationDialog=!1)},"取消"),i("button",{class:"confirm-btn",onClick:s[7]||(s[7]=(...o)=>r.submitCertification&&r.submitCertification(...o))},"确认")])])])):f("",!0),t.showPasswordDialog?(n(),d("div",{key:1,class:"dialog-overlay",onClick:s[17]||(s[17]=o=>t.showPasswordDialog=!1)},[i("div",{class:"dialog",onClick:s[16]||(s[16]=c(()=>{},["stop"]))},[i("div",j,[s[36]||(s[36]=i("h3",null,"修改密码",-1)),i("div",{class:"close-btn",onClick:s[10]||(s[10]=o=>t.showPasswordDialog=!1)},"×")]),i("div",z,[i("div",G,[s[37]||(s[37]=i("label",null,"原密码",-1)),l(i("input",{type:"password","onUpdate:modelValue":s[11]||(s[11]=o=>t.passwordForm.oldPassword=o),placeholder:"请输入原密码",class:"form-input"},null,512),[[a,t.passwordForm.oldPassword]])]),i("div",H,[s[38]||(s[38]=i("label",null,"新密码",-1)),l(i("input",{type:"password","onUpdate:modelValue":s[12]||(s[12]=o=>t.passwordForm.newPassword=o),placeholder:"请输入新密码",class:"form-input"},null,512),[[a,t.passwordForm.newPassword]])]),i("div",K,[s[39]||(s[39]=i("label",null,"确认新密码",-1)),l(i("input",{type:"password","onUpdate:modelValue":s[13]||(s[13]=o=>t.passwordForm.confirmPassword=o),placeholder:"请再次输入新密码",class:"form-input"},null,512),[[a,t.passwordForm.confirmPassword]])])]),i("div",L,[i("button",{class:"cancel-btn",onClick:s[14]||(s[14]=o=>t.showPasswordDialog=!1)},"取消"),i("button",{class:"confirm-btn",onClick:s[15]||(s[15]=(...o)=>r.changePassword&&r.changePassword(...o))},"确认")])])])):f("",!0)],64)}const ss=v(g,[["render",Q],["__scopeId","data-v-649c9399"]]);export{ss as default};
