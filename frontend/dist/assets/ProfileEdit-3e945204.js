import{u as p}from"./index-8cce7ed6.js";import{_ as m,o as u,c as d,b as s,d as n,v as l}from"./index-0403a620.js";const I={name:"ProfileEdit",data(){return{userInfo:{},isCertified:!1,editableUserInfo:{username:"",phoneNumber:"",email:"",region:"",userName:""}}},created(){const o=localStorage.getItem("userInfo");if(o)try{this.userInfo=JSON.parse(o),this.loadUserInfo()}catch(e){console.error("解析用户信息失败",e),this.userInfo={}}},methods:{async loadUserInfo(){if(!this.userInfo.userId){console.warn("缺少用户ID，无法加载用户信息");return}try{const o=await p.getUserInfo(this.userInfo.userId),e=o&&o.data||null;e&&e.userId&&(this.userInfo={...this.userInfo,...e},this.editableUserInfo={username:this.userInfo.username||"",phoneNumber:e.phoneNumber||"",email:e.email||"",region:e.region||"",userName:e.userName||""},this.isCertified=!!e.userName)}catch(o){console.error("加载用户信息失败",o)}},async saveProfile(){if(!this.userInfo.userId){alert("缺少用户ID，无法保存用户信息");return}try{const o={phoneNumber:this.editableUserInfo.phoneNumber,email:this.editableUserInfo.email,region:this.editableUserInfo.region},e=await p.updateUserInfo(this.userInfo.userId,o),i=e&&e.data||null;if(i){const a={...this.userInfo,...i};localStorage.setItem("userInfo",JSON.stringify(a)),this.userInfo=a,alert("保存成功"),this.$router.back()}}catch(o){console.error("保存用户信息失败",o),alert("保存失败: "+o.message)}}}},b={class:"profile-edit-page"},U={class:"header"},v={class:"edit-form"},c={class:"form-group"},h={class:"form-group"},g={class:"form-group"},N={class:"form-group"},y={class:"form-group"},_=["disabled"],k={key:0,class:"hint"},x={key:1,class:"hint"};function C(o,e,i,a,r,f){return u(),d("div",b,[s("div",U,[s("div",{class:"back-btn",onClick:e[0]||(e[0]=t=>o.$router.back())},[...e[7]||(e[7]=[s("span",null,"×",-1)])]),e[8]||(e[8]=s("h1",{class:"title"},"编辑资料",-1)),s("div",{class:"save-btn",onClick:e[1]||(e[1]=(...t)=>f.saveProfile&&f.saveProfile(...t))}," 保存 ")]),s("div",v,[s("div",c,[e[9]||(e[9]=s("label",null,"用户名",-1)),n(s("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=t=>r.editableUserInfo.username=t),placeholder:"请输入用户名",class:"form-input",disabled:""},null,512),[[l,r.editableUserInfo.username]]),e[10]||(e[10]=s("div",{class:"hint"},"用户名一经设置无法修改",-1))]),s("div",h,[e[11]||(e[11]=s("label",null,"手机号",-1)),n(s("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=t=>r.editableUserInfo.phoneNumber=t),placeholder:"请输入手机号",class:"form-input"},null,512),[[l,r.editableUserInfo.phoneNumber]])]),s("div",g,[e[12]||(e[12]=s("label",null,"邮箱",-1)),n(s("input",{type:"email","onUpdate:modelValue":e[4]||(e[4]=t=>r.editableUserInfo.email=t),placeholder:"请输入邮箱",class:"form-input"},null,512),[[l,r.editableUserInfo.email]])]),s("div",N,[e[13]||(e[13]=s("label",null,"所在地区",-1)),n(s("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=t=>r.editableUserInfo.region=t),placeholder:"请输入所在地区",class:"form-input"},null,512),[[l,r.editableUserInfo.region]])]),s("div",y,[e[14]||(e[14]=s("label",null,"真实姓名",-1)),n(s("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=t=>r.editableUserInfo.userName=t),placeholder:"请在安全设置中进行实名认证",class:"form-input",disabled:r.isCertified},null,8,_),[[l,r.editableUserInfo.userName]]),r.isCertified?(u(),d("div",x,"实名认证信息一经设置无法修改")):(u(),d("div",k,"请前往安全设置完成实名认证"))])])])}const D=m(I,[["render",C],["__scopeId","data-v-773f0ffc"]]);export{D as default};
